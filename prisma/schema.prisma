generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
    // directUrl = env("DIRECT_URL")
}

model User {
    id           String   @id @default(cuid())
    username     String   @unique @db.VarChar(100)
    name         String
    email        String   @unique
    password     String?  @db.VarChar(150)
    access_token String?  @db.VarChar(255)
    image        String?
    provider     String
    created_at   DateTime @default(now())
    updated_at   DateTime @updatedAt

    @@map("users")
}

model Customer {
    id                  String        @id @default(cuid()) // id unik otomatis
    name                String        @db.VarChar(50) // nama
    national_id         String        @unique @db.VarChar(30) // NIK
    id_card_address     String        @db.VarChar(100) // alamat KTP
    residential_address String        @db.VarChar(100) // alamat tinggal
    occupation          String        @db.VarChar(100) // pekerjaan
    phone               String        @db.VarChar(20) // nomor telepon
    loanReference_id    String
    guarantor_id        String
    guarantor           Guarantor     @relation(fields: [guarantor_id], references: [id])
    loan_reference      LoanReference @relation(fields: [loanReference_id], references: [id])
    created_at          DateTime      @default(now())
    updated_at          DateTime      @updatedAt

    @@map("customers")
}

model Guarantor {
    id                  String     @id @default(cuid()) // id unik otomatis
    name                String     @db.VarChar(50) // nama
    national_id         String     @unique @db.VarChar(30) // NIK
    id_card_address     String     @db.VarChar(100) // alamat KTP
    residential_address String     @db.VarChar(100) // alamat tinggal
    occupation          String     @db.VarChar(100) // pekerjaan
    phone               String     @db.VarChar(20) // nomor telepon
    Customer            Customer[]
    created_at          DateTime   @default(now())
    updated_at          DateTime   @updatedAt

    @@map("guarantors")
}

model LoanReference {
    id                      String     @id @default(cuid()) // id unik otomatis
    monthly_income          String // pendapatan bulanan
    monthly_expenses        String // pengeluaran bulanan
    employment_status       String // status pekerjaan tetap/tidak tetap
    previous_credit_history Boolean // riwayat kredit sebelumnya
    requested_loan_amount   String // jumlah pinjaman yang diajukan
    has_collateral          Boolean // memiliki jaminan atau aset
    collateral_estimate     String // taksiran jaminan
    maximum_loan            String // maksimal pinjaman
    loan_term               Int // jangka waktu pinjaman (bulan)
    creditworthiness        Boolean // kelayakan kredit
    Customer                Customer[]
    created_at              DateTime   @default(now())
    updated_at              DateTime   @updatedAt

    @@map("loan_references")
}
